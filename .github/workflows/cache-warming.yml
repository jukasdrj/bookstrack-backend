name: Cache Warming

on:
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM UTC
  workflow_dispatch:  # Allow manual trigger

jobs:
  warm-cache:
    runs-on: ubuntu-latest
    name: Warm API Cache
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install dependencies
        run: npm install

      - name: Warm Popular Books Cache
        run: |
          echo "Warming cache for popular books..."
          # Example: curl high-traffic ISBNs
          for isbn in 9780439708180 9780385529985 9780743273565; do
            curl -s "https://api.oooefam.net/search/isbn?isbn=$isbn" > /dev/null
            sleep 1
          done

      - name: Cache Warming Complete
        run: echo "âœ… Cache warming complete"
